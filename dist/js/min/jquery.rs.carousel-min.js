/*! jquery.rs.carousel-min.js | 1.0.0 | 2013-04-27 | http://richardscarrott.github.com/jquery-ui-carousel/ */
(function(t,e){"use strict";var i=t.Widget.prototype;t.widget("rs.carousel",{version:"1.0.0",options:{mask:"> div",runner:"> ul",items:"> li",itemsPerTransition:"auto",orientation:"horizontal",loop:!1,whitespace:!1,nextPrevActions:!0,insertPrevAction:function(){return t('<a href="#" class="rs-carousel-action rs-carousel-action-prev">Prev</a>').appendTo(this)},insertNextAction:function(){return t('<a href="#" class="rs-carousel-action rs-carousel-action-next">Next</a>').appendTo(this)},pagination:!0,insertPagination:function(e){return t(e).insertAfter(t(this).find(".rs-carousel-mask"))},speed:"normal",easing:"swing",fx:"slide",translate3d:!1,create:null,before:null,after:null},_create:function(){this.widgetFullName=this.widgetFullName||this.widgetBaseClass,this.eventNamespace=this.eventNamespace||"."+this.widgetName,this.index=0,this._elements(),this._setIsHorizontal(),this._addMask(),this._addNextPrevActions(),this.refresh(!1)},_elements:function(){var t=this.elements={},e=this.widgetFullName;this.element.addClass(e),t.mask=this.element.find(this.options.mask).addClass(e+"-mask"),t.runner=(t.mask.length?t.mask:this.element).find(this.options.runner).addClass(e+"-runner"),t.items=t.runner.find(this.options.items).addClass(e+"-item")},_setIsHorizontal:function(){var t=this.elements,e=this.widgetFullName;this.element.removeClass(e+"-horizontal").removeClass(e+"-vertical"),"horizontal"===this.options.orientation?(this.isHorizontal=!0,this.element.addClass(e+"-horizontal"),t.runner.css("top","")):(this.isHorizontal=!1,this.element.addClass(e+"-vertical"),t.runner.css("left",""))},_addMask:function(){var t=this.elements;t.mask.length||(t.mask=t.runner.wrap('<div class="'+this.widgetFullName+'-mask" />').parent(),this.maskAdded=!0)},_addNextPrevActions:function(){if(this.options.nextPrevActions){var t=this,e=this.elements,i=this.options,s=this.eventNamespace;this._removeNextPrevActions(),e.prevAction=i.insertPrevAction.apply(this.element[0]).bind("click"+s,function(e){e.preventDefault(),t.prev()}),e.nextAction=i.insertNextAction.apply(this.element[0]).bind("click"+s,function(e){e.preventDefault(),t.next()})}},_removeNextPrevActions:function(){var t=this.elements;t.nextAction&&(t.nextAction.remove(),t.nextAction=e),t.prevAction&&(t.prevAction.remove(),t.prevAction=e)},refresh:function(t){t!==!1&&this._recacheItems(),this._setPages(),this._addPagination(),this._setRunnerWidth(),this.index=this._makeValid(this.index),this.goToPage(this.index,!1,e,!0),this._checkDisabled()},_recacheItems:function(){this.elements.items=this.elements.runner.find(this.options.items).addClass(this.widgetFullName+"-item")},_setPages:function(){var t,i=this,s=0,n=isNaN(this.options.itemsPerTransition)?e:this._getLastItemIndex();for(this.pages=[];this.getNoOfItems()>s;)if(isNaN(this.options.itemsPerTransition))this.pages.push(i._getVisibleItems(s)),s+=this.pages[this.pages.length-1].length;else{if(s>=n){this.pages.push(this.elements.items.slice(s));break}t=s,s+=parseInt(this.options.itemsPerTransition,10),this.pages.push(this.elements.items.slice(t,s))}},_getLastItemIndex:function(){return this.options.whitespace?e:this.elements.items.index(this._getVisibleItems(0,!0).last())},_getVisibleItems:function(i,s){var n=this,a=[],o=s?[].reverse.apply(t(this.elements.items)).slice(i):this.elements.items.slice(i),r=this._getMaskDim(),h=0;return o.each(function(){return h+=n.isHorizontal?t(this).outerWidth(!0):t(this).outerHeight(!0),h>r?(0===a.length&&a.push(this),!1):(a.push(this),e)}),t(a)},_getMaskDim:function(){return this.elements.mask[this.isHorizontal?"width":"height"]()},getNoOfItems:function(){return this.elements.items.length},_addPagination:function(){if(this.options.pagination){var e,i=this,s=this.widgetFullName,n=t('<ol class="'+s+'-pagination" />'),a=[],o=this.getNoOfPages();for(this._removePagination(),e=0;o>e;e++)a[e]='<li class="'+s+'-pagination-link"><a href="#page-'+e+'">'+(e+1)+"</a></li>";n.append(a.join("")).delegate("a","click"+this.eventNamespace,function(t){t.preventDefault(),i.goToPage(parseInt(this.hash.split("-")[1],10))}),this.elements.pagination=this.options.insertPagination.call(this.element[0],n)}},_removePagination:function(){this.elements.pagination&&(this.elements.pagination.remove(),this.elements.pagination=e)},getNoOfPages:function(){return this.pages.length},_checkDisabled:function(){1>=this.getNoOfPages()?(this.disable(),this._disabled=!0):this._disabled&&(this.enable(),this._disabled=!1)},_setRunnerWidth:function(){var e=this.elements,i=0;e.runner.width(""),this.isHorizontal&&e.runner.width(function(){return e.items.each(function(){i+=t(this).outerWidth(!0)}),i})},next:function(t){var e=this.index+1;this.options.loop&&e>=this.getNoOfPages()&&(e=0),this.goToPage(e,t,"carousel:next")},prev:function(t){var e=this.index-1;this.options.loop&&0>e&&(e=this.getNoOfPages()-1),this.goToPage(e,t,"carousel:prev")},goToPage:function(e,i,s,n){i=i===!1?!1:!0,!this.options.disabled&&this._isValid(e)&&(this.prevIndex=this.index,this.index=e,this["_"+this.options.fx](t.Event(s?s:"carousel:gotopage",{animate:i,speed:i?this.options.speed:0}),n)),this._updateUi()},goToItem:function(e,i){var s,n,a,o;isNaN(e)||(e=this.elements.items.eq(e)),e.jquery&&(e=e[0]);t:for(s=0,n=this.getNoOfPages();n>s;s++)for(a=0,o=this.getPage(s).length;o>a;a++)if(this.getPage(s)[a]===e)break t;return this.goToPage(s,i),t(e)},_isValid:function(t){return this.getNoOfPages()>t&&t>=0?!0:!1},_makeValid:function(t){return 0>t?t=0:t>=this.getNoOfPages()&&(t=this.getNoOfPages()-1),t},_slide:function(t,i){var s,n=this,a={},o=this._getAbsoluteLastPos(),r=this.getPage(),h=r.first().position()[this.isHorizontal?"left":"top"],l=this.eventNamespace,d=this.widgetFullName;return i||this._trigger("before",t,this._getEventData())?(h>o&&(h=o),this.options.translate3d?(s=["transitionend"+l,"webkitTransitionEnd"+l,"oTransitionEnd"+l],t.animate&&this.element.addClass(d+"-transition"),this.elements.runner.unbind(s.join(" ")).on(s.join(" "),function(t){n.element.removeClass(d+"-transition"),i||n._trigger("after",t,n._getEventData())}).css("transform","translate3d("+(this.isHorizontal?-h+"px, 0, 0":"0, "+-h+"px, 0")+")"),t.animate||(n.element.removeClass(d+"-transition"),i||n._trigger("after",t,n._getEventData()))):(a[this.isHorizontal?"left":"top"]=-h,this.elements.runner.stop().animate(a,t.speed,this.options.easing,function(){i||n._trigger("after",t,n._getEventData())})),e):(this.index=this.prevIndex,e)},_getAbsoluteLastPos:function(){if(!this.options.whitespace){var t,i=this.elements.items.eq(this.getNoOfItems()-1),s=i.position()[this.isHorizontal?"left":"top"],n=i[this.isHorizontal?"outerWidth":"outerHeight"](!0);return t=s+n-this._getMaskDim(),0>t?e:t}},getPage:function(i){return this.pages[i!==e?i:this.index]||t([])},getPages:function(){return this.pages},_getEventData:function(){return{page:this.getPage(),prevPage:this.getPage(this.prevIndex),elements:this.elements}},_getCreateEventData:function(){return this._getEventData()},_updateUi:function(){this._updateActiveItems(),this.options.pagination&&this._updatePagination(),this.options.nextPrevActions&&this._updateNextPrevActions()},_updateActiveItems:function(){var t=this.widgetFullName,e=t+"-item-active";this.elements.items.removeClass(e),this.getPage().addClass(e)},_updatePagination:function(){var t=this.widgetFullName,e=t+"-pagination-link-active",i=t+"-pagination-disabled",s=this.elements.pagination.removeClass(i);this.options.disabled&&s.addClass(i),s.children("."+t+"-pagination-link").removeClass(e).eq(this.index).addClass(e)},_updateNextPrevActions:function(){var t=this.elements,e=t.nextAction.add(t.prevAction),i=this.index,s=this.widgetFullName,n=s+"-action-active",a=s+"-action-disabled";e.addClass(n).removeClass(a),this.options.disabled&&e.addClass(a),this.options.loop||(i===this.getNoOfPages()-1&&t.nextAction.removeClass(n),0===i&&t.prevAction.removeClass(n))},_setOption:function(t,e){switch(i._setOption.apply(this,arguments),t){case"orientation":this._setIsHorizontal(),this.refresh();break;case"pagination":e?(this._addPagination(),this._updateUi()):this._removePagination();break;case"nextPrevActions":e?(this._addNextPrevActions(),this._updateUi()):this._removeNextPrevActions();break;case"loop":case"disabled":this._updateUi();break;case"itemsPerTransition":case"whitespace":this.refresh()}},add:function(t){this.elements.runner.append(t),this.refresh()},remove:function(t){this.getNoOfItems()>0&&(this.elements.items.filter(t).remove(),this.refresh())},getIndex:function(){return this.index},getPrevIndex:function(){return this.prevIndex},destroy:function(){var t=this.elements,e=this.widgetFullName,s={};this.element.removeClass(e).removeClass(e+"-horizontal").removeClass(e+"-vertical"),t.mask.removeClass(e+"-mask"),t.runner.removeClass(e+"-runner"),t.items.removeClass(e+"-item"),this.maskAdded&&t.runner.unwrap(),s[this.isHorizontal?"left":"top"]="",s[this.isHorizontal?"width":"height"]="",s.transform="",t.runner.css(s),this._removePagination(),this._removeNextPrevActions(),t.runner.unbind(this.eventNamespace),i.destroy.apply(this,arguments)}})})(jQuery);